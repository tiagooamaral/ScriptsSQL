     Select ESTMVVD2.*, CDSIT.*, CDUNIDADE.*, CDCLA.*, 
         COALESCE(ESTMVVD2.VD2_CSOSN, CDCSOSN.CSO_CSO) CSO_CSO, 
         CDSITIPI.IPI_CST, CDSITPIS.PIS_CST, CDSITCOFINS.COF_CST, 
         CDSITIPI.IPI_ALQ, CDSITPIS.PIS_ALQ, CDSITCOFINS.COF_ALQ, 
         CDCOR.*, CDMED.*, CDPROCM.*, CDTRA1.TRA_DIGITACAO, 
         CDTRA1.TRA_DIGITA_ICMS, CDTRA1.TRA_DIGITA_IPI, CDTRA1.TRA_IMP_COD_DESC, 
         CDTRANFE.TRA_CODIGO_EAN, CDTRANFE.TRA_CODIGO_EAN_TRIB, 
         CDPRO.PRO_INT, CDPRO.PRO_BAR, CDPRO.PRO_CODAUX1, CDPRO.PRO_CODAUX2, 
         CDPRO.PRO_UNC, 
         ESTMVVD1.VD1_CLI_CONS_REV, 
         ESTMVVD1.VD1_VAL_SUB_TRIBUTA, ESTMVVD1.VD1_BASE_SUB_TRIBUTA, 
         ESTMVVD1.VD1_VALOR_TOTALB_SUB_TRIBUTA, 
         ESTMVVD1.VD1_VALB_SUB_TRIBUTA, ESTMVVD1.VD1_BASEB_SUB_TRIBUTA, 
         ESTMVVD1.VD1_VALOR_IPI, ESTMVVD1.VD1_VALOR_ICMS, 
         COALESCE(NULLIF(VD2_CFOP,''), CFO_CFO) AS CFO_CFO,
         CDCFO.CFO_INCLUI_DESPESAS, 
         CDTAB_IBPT.TAB_ALIQ_NAC 
      From ESTMVVD2 
         Inner join ESTMVVD1 on (ESTMVVD2.VD2_BOL = ESTMVVD1.VD1_COD) 
         Left join CDCFO on (CDCFO.CFO_COD = ESTMVVD1.VD1_CFOP) 
         Left join CDTRA1 on (CDTRA1.TRA_COD = ESTMVVD1.VD1_TRA) 
         Left join CDTRANFE on (CDTRANFE.TRA_TRA = ESTMVVD1.VD1_TRA) 
         Left join CDSIT on (ESTMVVD2.VD2_SITUACAOTRIBUTARIA = CDSIT.SIT_COD) 
         Left join CDUNIDADE on (ESTMVVD2.UNIDADE = CDUNIDADE.CODIGO) 
         Left join CDPRO on (ESTMVVD2.VD2_PRO = CDPRO.PRO_COD) 
         Left join CDCOR on (ESTMVVD2.VD2_COR = CDCOR.COR_COD) 
         Left join CDMED on (ESTMVVD2.VD2_MED = CDMED.MED_COD) 
         Left join CDPROCM on (ESTMVVD2.VD2_PRO = CDPROCM.PRO_PRO AND ESTMVVD2.VD2_COR = CDPROCM.PRO_COR AND ESTMVVD2.VD2_MED = CDPROCM.PRO_MED) 
         Left join CDCLA on (CDCLA.CLA_COD = CDPRO.PRO_CLA) 
         Left join CDSITIPI on (CDSITIPI.IPI_COD = COALESCE(NULLIF(ESTMVVD2.VD2_IPI_CST,0),CDPRO.PRO_CST_IPI)) 
         Left join CDSITPIS on (CDSITPIS.PIS_COD = COALESCE(NULLIF(ESTMVVD2.VD2_PIS_CST,0),CDPRO.PRO_CST_PIS)) 
         Left join CDSITCOFINS on (CDSITCOFINS.COF_COD = COALESCE(NULLIF(ESTMVVD2.VD2_COFINS_CST,0),CDPRO.PRO_CST_COFINS)) 
         Left join CDPROCSOSN on (CDPROCSOSN.CSO_PRO = ESTMVVD2.VD2_PRO AND CDPROCSOSN.CSO_ALM = ESTMVVD2.VD2_ALM) 
         Left join CDCSOSN on (CDCSOSN.CSO_COD = COALESCE(CDPROCSOSN.CSO_CSO, CDPRO.PRO_CSOSN)) 
         Left join CDTAB_IBPT on (CDCLA.CLA_NCM_NUMERICOS = CDTAB_IBPT.TAB_NCM AND CDTAB_IBPT.TAB_EX = '')
      Where VD1_COD = '0000040894001'
